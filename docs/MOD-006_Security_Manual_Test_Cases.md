# MOD-006 安全与隐私模块 - 人工测试用例

**文档版本:** 1.0
**创建日期:** 2026-02-03
**测试范围:** MOD-006 Security & Privacy Module
**测试环境:** iOS 14+ / Android 7+ (API 24+)

---

## 目录

1. [测试环境准备](#测试环境准备)
2. [密钥管理测试](#密钥管理测试)
3. [恢复套件测试](#恢复套件测试)
4. [生物识别测试](#生物识别测试)
5. [PIN认证测试](#pin认证测试)
6. [字段加密测试](#字段加密测试)
7. [数据库加密测试](#数据库加密测试)
8. [哈希链完整性测试](#哈希链完整性测试)
9. [集成测试场景](#集成测试场景)
10. [性能测试](#性能测试)
11. [安全检查清单](#安全检查清单)

---

## 测试环境准备

### 前置条件

1. **设备要求:**
   - iOS设备: iPhone 6s或更新 (iOS 14+)
   - Android设备: Android 7.0+ (API 24+)
   - 真机测试（生物识别功能需要真机）

2. **权限设置:**
   - iOS: Info.plist中已配置生物识别权限
   - Android: AndroidManifest.xml中已配置生物识别和安全存储权限

3. **访问测试界面:**
   ```
   导航路径: /security-test
   或在应用中通过开发者菜单进入
   ```

4. **初始化状态:**
   - 清除应用数据（首次测试）
   - 确保设备已设置系统PIN/密码
   - 确保设备已注册生物识别（Face ID/Touch ID/指纹）

---

## 密钥管理测试

### TC-KEY-001: 生成设备密钥对

**测试目的:** 验证Ed25519密钥对生成功能

**前置条件:** 无

**测试步骤:**
1. 打开安全测试屏幕
2. 点击 "生成设备密钥对" 按钮
3. 观察结果显示

**预期结果:**
- ✅ 显示 "密钥对生成成功"
- ✅ 显示设备ID（16字符长度）
- ✅ 显示公钥长度信息
- ✅ 设备ID格式：`^[0-9a-f]{16}$`
- ✅ 公钥为Base64编码字符串

**测试数据示例:**
```
设备ID: a1b2c3d4e5f6g7h8
公钥长度: 88 字符
```

**失败标准:**
- ❌ 抛出异常
- ❌ 设备ID不是16字符
- ❌ 公钥格式错误

---

### TC-KEY-002: 检查密钥是否存在

**测试目的:** 验证密钥存在性检查功能

**前置条件:**
- 场景A: 未生成密钥
- 场景B: 已生成密钥

**测试步骤:**
1. 场景A: 清除应用数据
2. 点击 "检查密钥是否存在"
3. 执行TC-KEY-001生成密钥
4. 场景B: 再次点击 "检查密钥是否存在"

**预期结果:**
- 场景A: ⚠️ "密钥对不存在，请先生成"
- 场景B: ✅ "密钥对已存在"

---

### TC-KEY-003: 密钥持久化验证

**测试目的:** 验证密钥存储在安全存储中且应用重启后仍然存在

**前置条件:** 已生成密钥对（TC-KEY-001）

**测试步骤:**
1. 生成密钥对
2. 记录设备ID
3. 完全关闭应用（从后台移除）
4. 重新打开应用
5. 检查密钥是否存在
6. 再次生成密钥对
7. 对比设备ID

**预期结果:**
- ✅ 重启后密钥仍存在
- ✅ 设备ID保持不变
- ⚠️ 注意：再次生成会创建新的密钥对（设备ID会变化）

---

### TC-KEY-004: 密钥恢复功能

**测试目的:** 验证从BIP39种子恢复密钥的功能

**前置条件:**
- 已生成恢复套件（TC-REC-001）
- 记录原始设备ID

**测试步骤:**
1. 生成并保存24词助记词
2. 记录当前设备ID
3. 清除应用数据（模拟设备丢失）
4. 使用助记词恢复密钥
5. 对比恢复后的设备ID

**预期结果:**
- ✅ 使用相同助记词恢复产生相同的密钥
- ✅ 设备ID保持一致
- ✅ 公钥保持一致

**注意事项:**
- 密钥恢复是确定性的（同一种子→同一密钥）

---

## 恢复套件测试

### TC-REC-001: 生成24词助记词

**测试目的:** 验证BIP39助记词生成功能

**前置条件:** 无

**测试步骤:**
1. 点击 "生成24词助记词"
2. 观察生成的助记词
3. 记录助记词

**预期结果:**
- ✅ 生成24个英文单词
- ✅ 单词间用空格分隔
- ✅ 所有单词都在BIP39词表中
- ✅ 助记词可复制
- ✅ 助记词显示在黄色卡片中

**测试数据示例:**
```
abandon ability able about above absent absorb abstract absurd abuse access accident account accuse achieve acid acoustic acquire across act action actor actress actual
```

---

### TC-REC-002: 验证助记词

**测试目的:** 验证助记词有效性检查

**前置条件:** 已生成助记词（TC-REC-001）

**测试步骤:**
1. 生成助记词
2. 点击 "验证助记词"
3. 观察验证结果

**预期结果:**
- ✅ 显示 "助记词验证通过"
- ✅ 验证通过后可用于密钥恢复

---

### TC-REC-003: 助记词唯一性测试

**测试目的:** 验证每次生成的助记词都是唯一的

**前置条件:** 无

**测试步骤:**
1. 生成第1个助记词，记录
2. 清除数据
3. 生成第2个助记词，记录
4. 重复3-5次
5. 对比所有助记词

**预期结果:**
- ✅ 每次生成的助记词都不同
- ✅ 助记词随机性良好

---

### TC-REC-004: 无效助记词检测

**测试目的:** 验证系统能够拒绝无效助记词

**前置条件:** 无

**测试步骤:**
1. 修改代码，尝试验证无效助记词：
   - 词数不足/过多（<24或>24）
   - 包含不在BIP39词表中的单词
   - 校验和错误

**预期结果:**
- ✅ 词数错误: 验证失败
- ✅ 无效单词: 验证失败
- ✅ 校验和错误: 验证失败

**测试数据:**
```dart
// 测试无效词数
"word word word"  // 只有3个词

// 测试无效单词
"abandon ability invalidword ..."  // 包含无效单词
```

---

### TC-REC-005: 随机词验证流程

**测试目的:** 模拟用户抄写验证流程

**前置条件:** 已生成助记词

**测试步骤:**
1. 生成24词助记词
2. 调用 `getRandomWordsForVerification()` 获取3个随机位置
3. 验证返回的索引在0-23范围内
4. 验证3个索引都不相同
5. 用户在这3个位置填写对应单词
6. 完整验证助记词

**预期结果:**
- ✅ 返回3个随机索引
- ✅ 索引在有效范围内 (0-23)
- ✅ 3个索引互不相同
- ✅ 用户填写正确单词后验证通过

---

## 生物识别测试

### TC-BIO-001: 检查生物识别可用性

**测试目的:** 验证系统能正确检测设备生物识别能力

**前置条件:**
- 场景A: iPhone with Face ID
- 场景B: iPhone with Touch ID
- 场景C: Android with Fingerprint
- 场景D: 未注册生物识别的设备
- 场景E: 不支持生物识别的设备

**测试步骤:**
1. 在不同设备上点击 "检查生物识别可用性"
2. 观察返回的可用性状态

**预期结果:**
- 场景A: "Face ID 可用"
- 场景B: "指纹识别可用"
- 场景C: "指纹识别可用"
- 场景D: "未注册生物识别"
- 场景E: "不支持生物识别"

---

### TC-BIO-002: 生物识别认证成功

**测试目的:** 验证生物识别认证成功流程

**前置条件:**
- 设备已注册生物识别
- 生物识别可用

**测试步骤:**
1. 点击 "执行生物识别认证"
2. 出现系统生物识别提示
3. 使用正确的生物识别方式（人脸/指纹）
4. 观察认证结果

**预期结果:**
- ✅ 显示 "认证成功"
- ✅ 系统提示框显示 "验证您的身份以继续"
- ✅ 认证成功后失败计数器重置

---

### TC-BIO-003: 生物识别认证失败

**测试目的:** 验证生物识别认证失败处理

**前置条件:**
- 设备已注册生物识别
- 生物识别可用

**测试步骤:**
1. 点击 "执行生物识别认证"
2. 故意使用错误的生物识别（遮挡人脸/使用未注册的指纹）
3. 观察失败提示
4. 查看失败次数

**预期结果:**
- ❌ 显示 "认证失败 (尝试次数: 1)"
- ✅ 失败计数器递增
- ⚠️ 允许重试

---

### TC-BIO-004: 失败次数限制

**测试目的:** 验证3次失败后锁定机制

**前置条件:**
- 设备已注册生物识别
- 生物识别可用

**测试步骤:**
1. 第1次: 故意失败
2. 第2次: 故意失败
3. 第3次: 故意失败
4. 第4次: 尝试认证
5. 观察结果

**预期结果:**
- ❌ 第1-3次: "认证失败 (尝试次数: 1/2/3)"
- ❌ 第4次: "尝试次数过多" 或系统锁定提示
- ⚠️ 需要等待或使用PIN码

---

### TC-BIO-005: PIN降级测试

**测试目的:** 验证生物识别不可用时降级到PIN

**前置条件:**
- 设备未注册生物识别 或 生物识别被禁用

**测试步骤:**
1. 禁用设备生物识别
2. 点击 "执行生物识别认证"
3. 观察降级提示

**预期结果:**
- ⚠️ 显示 "需要使用PIN码"
- ✅ 系统提示用户使用PIN认证

---

### TC-BIO-006: 失败计数器重置

**测试目的:** 验证认证成功后失败计数器重置

**前置条件:** 已执行TC-BIO-003（有失败记录）

**测试步骤:**
1. 先故意失败2次
2. 第3次使用正确的生物识别
3. 再次故意失败
4. 查看失败次数

**预期结果:**
- ✅ 成功认证后计数器重置为0
- ✅ 下次失败显示 "尝试次数: 1"（而不是3或4）

---

## PIN认证测试

### TC-PIN-001: 设置PIN码

**测试目的:** 验证6位数字PIN码设置功能

**前置条件:** 无

**测试步骤:**
1. 在PIN输入框输入: `123456`
2. 点击 "设置PIN码"
3. 观察结果

**预期结果:**
- ✅ 显示 "PIN码设置成功"
- ✅ PIN以SHA-256哈希存储（非明文）
- ✅ 后续可以验证此PIN

**测试数据:**
```
有效PIN: 123456, 000000, 999999
```

---

### TC-PIN-002: PIN码验证成功

**测试目的:** 验证正确PIN码验证

**前置条件:** 已设置PIN为 `123456`

**测试步骤:**
1. 在PIN输入框输入: `123456`
2. 点击 "验证PIN码"
3. 观察结果

**预期结果:**
- ✅ 显示 "PIN码正确"

---

### TC-PIN-003: PIN码验证失败

**测试目的:** 验证错误PIN码拒绝

**前置条件:** 已设置PIN为 `123456`

**测试步骤:**
1. 在PIN输入框输入: `654321`
2. 点击 "验证PIN码"
3. 观察结果

**预期结果:**
- ❌ 显示 "PIN码错误"
- ⚠️ 不泄露正确PIN信息

---

### TC-PIN-004: PIN格式验证

**测试目的:** 验证PIN码格式要求（必须6位数字）

**前置条件:** 无

**测试步骤:**
尝试设置以下PIN:
1. `12345` (5位)
2. `1234567` (7位)
3. `12345a` (包含字母)
4. `123 456` (包含空格)

**预期结果:**
- ❌ 所有无效格式都应拒绝
- ✅ 显示错误: "PIN must be exactly 6 digits"
- ✅ 显示错误: "PIN must contain only digits"

**测试数据:**
```dart
// 无效PIN示例
"12345"   // 长度错误
"1234567" // 长度错误
"12345a"  // 包含非数字
"123 456" // 包含空格
```

---

### TC-PIN-005: 检查PIN设置状态

**测试目的:** 验证PIN设置状态检查

**前置条件:**
- 场景A: 未设置PIN
- 场景B: 已设置PIN

**测试步骤:**
1. 场景A: 清除应用数据
2. 点击 "检查PIN是否已设置"
3. 设置PIN
4. 场景B: 再次点击检查

**预期结果:**
- 场景A: ⚠️ "PIN未设置"
- 场景B: ✅ "PIN已设置"

---

### TC-PIN-006: PIN码修改

**测试目的:** 验证PIN码可以更改

**前置条件:** 已设置PIN为 `123456`

**测试步骤:**
1. 调用 `changePIN(oldPIN: "123456", newPIN: "999999")`
2. 验证旧PIN `123456` (应失败)
3. 验证新PIN `999999` (应成功)

**预期结果:**
- ✅ PIN修改成功
- ❌ 旧PIN不再有效
- ✅ 新PIN可以验证成功

---

### TC-PIN-007: PIN码删除

**测试目的:** 验证PIN码可以删除

**前置条件:** 已设置PIN

**测试步骤:**
1. 调用 `deletePIN()`
2. 检查PIN设置状态
3. 尝试验证任何PIN

**预期结果:**
- ✅ PIN删除成功
- ⚠️ "PIN未设置"
- ❌ 所有PIN验证都失败

---

### TC-PIN-008: PIN安全存储验证

**测试目的:** 验证PIN以哈希形式存储，非明文

**前置条件:** 已设置PIN `123456`

**测试步骤:**
1. 设置PIN `123456`
2. 检查Keychain/Keystore中存储的值
3. 验证存储的是SHA-256哈希而非明文

**预期结果:**
- ✅ 存储值是64字符的十六进制字符串（SHA-256）
- ✅ 存储值 ≠ `123456`
- ✅ 示例哈希: `8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92`

**安全检查:**
```dart
// PIN "123456" 的SHA-256哈希
Expected hash: "8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92"
```

---

## 字段加密测试

### TC-ENC-001: 加密文本字段

**测试目的:** 验证ChaCha20-Poly1305加密功能

**前置条件:** 已生成设备密钥（TC-KEY-001）

**测试步骤:**
1. 在 "要加密的文本" 输入框输入: `敏感财务数据`
2. 点击 "加密文本"
3. 观察加密结果

**预期结果:**
- ✅ 显示 "加密成功"
- ✅ 密文长度 > 明文长度
- ✅ 密文是Base64编码
- ✅ 密文不包含原文内容
- ✅ 密文显示在绿色卡片中

**测试数据:**
```
明文: 敏感财务数据
密文示例: ZjM2NzY4YmQtYjU5Yy00ZGVhLWE4NDctYWI3ZmQ3MGIxMzAx...
```

---

### TC-ENC-002: 解密文本字段

**测试目的:** 验证加密数据可以正确解密

**前置条件:** 已执行TC-ENC-001（有加密数据）

**测试步骤:**
1. 加密文本 `敏感财务数据`
2. 点击 "解密文本"
3. 对比解密结果

**预期结果:**
- ✅ 显示 "解密成功"
- ✅ 解密后的明文 = 原始明文
- ✅ 解密文本: `敏感财务数据`

---

### TC-ENC-003: 加密唯一性（随机Nonce）

**测试目的:** 验证相同明文每次加密结果不同（Nonce随机性）

**前置条件:** 已生成设备密钥

**测试步骤:**
1. 加密文本 `test`，记录密文1
2. 清除结果
3. 再次加密文本 `test`，记录密文2
4. 对比两个密文

**预期结果:**
- ✅ 密文1 ≠ 密文2（随机Nonce导致）
- ✅ 两个密文都可以正确解密为 `test`

---

### TC-ENC-004: 加密空字符串

**测试目的:** 验证空字符串加密处理

**前置条件:** 已生成设备密钥

**测试步骤:**
1. 加密空字符串 ``
2. 解密结果
3. 验证解密值

**预期结果:**
- ✅ 可以加密空字符串
- ✅ 解密后仍为空字符串

---

### TC-ENC-005: 加密Unicode字符

**测试目的:** 验证Unicode字符加密

**前置条件:** 已生成设备密钥

**测试步骤:**
1. 加密包含Unicode的文本: `こんにちは世界 🌏 Émoji`
2. 解密结果
3. 验证字符完整性

**预期结果:**
- ✅ 所有Unicode字符正确加密
- ✅ 解密后Unicode字符完整
- ✅ Emoji正确保留

---

### TC-ENC-006: 加密金额

**测试目的:** 验证金额加密功能

**前置条件:** 已生成设备密钥

**测试步骤:**
1. 调用 `encryptAmount(12345.67)`
2. 调用 `decryptAmount(encrypted)`
3. 验证解密金额

**预期结果:**
- ✅ 金额正确加密为字符串
- ✅ 解密后精度保持: `12345.67`
- ✅ 支持负数: `-100.50`
- ✅ 支持零: `0.00`

**测试数据:**
```dart
12345.67  → 加密 → 解密 → 12345.67
-100.50   → 加密 → 解密 → -100.50
0.00      → 加密 → 解密 → 0.00
```

---

### TC-ENC-007: 篡改检测（AEAD）

**测试目的:** 验证ChaCha20-Poly1305 AEAD的篡改检测能力

**前置条件:** 已加密数据

**测试步骤:**
1. 加密文本 `original`
2. 修改密文中的一个字节
3. 尝试解密被篡改的密文

**预期结果:**
- ❌ 解密失败
- ✅ 抛出异常或返回错误
- ✅ 不返回错误的解密结果

---

### TC-ENC-008: 密钥依赖性

**测试目的:** 验证不同密钥无法解密

**前置条件:** 无

**测试步骤:**
1. 使用密钥A加密文本 `secret`
2. 清除应用数据
3. 生成新密钥B
4. 尝试用密钥B解密之前的密文

**预期结果:**
- ❌ 解密失败
- ✅ 确保密钥隔离性

---

## 数据库加密测试

### TC-DB-001: SQLCipher加密验证

**测试目的:** 验证数据库使用SQLCipher加密

**前置条件:** 已生成设备密钥

**测试步骤:**
1. 创建加密数据库
2. 检查数据库文件不可直接读取
3. 尝试用SQLite工具打开数据库文件

**预期结果:**
- ❌ SQLite工具无法打开（文件已加密）
- ✅ 应用内可正常读写数据库

---

### TC-DB-002: 数据库密钥派生

**测试目的:** 验证数据库密钥从设备公钥派生

**前置条件:** 已生成设备密钥

**测试步骤:**
1. 生成设备密钥对
2. 创建加密数据库
3. 验证使用派生密钥可以访问

**预期结果:**
- ✅ 密钥派生成功
- ✅ 使用派生密钥可访问数据库

---

### TC-DB-003: PBKDF2迭代次数

**测试目的:** 验证PBKDF2配置为256,000次迭代

**前置条件:** 已创建加密数据库

**测试步骤:**
1. 创建加密数据库
2. 执行 `PRAGMA kdf_iter;`
3. 检查返回值

**预期结果:**
- ✅ 迭代次数 = 256000

---

### TC-DB-004: 加密算法验证

**测试目的:** 验证使用AES-256-CBC

**前置条件:** 已创建加密数据库

**测试步骤:**
1. 创建加密数据库
2. 执行 `PRAGMA cipher;`
3. 检查返回值

**预期结果:**
- ✅ 加密算法 = `aes-256-cbc`

---

## 哈希链完整性测试

### TC-HASH-001: 创建交易链

**测试目的:** 验证哈希链创建功能

**前置条件:** 无

**测试步骤:**
1. 点击 "创建并验证交易链"
2. 观察创建5笔交易
3. 查看验证结果

**预期结果:**
- ✅ 创建5笔交易
- ✅ 每笔交易有唯一hash
- ✅ previousHash链接正确
- ✅ 链验证通过: "链状态: 完整"

---

### TC-HASH-002: 篡改检测

**测试目的:** 验证哈希链可以检测数据篡改

**前置条件:** 无

**测试步骤:**
1. 点击 "测试篡改检测"
2. 系统创建3笔交易
3. 系统篡改第2笔交易金额
4. 验证链完整性

**预期结果:**
- ✅ 检测到篡改
- ✅ 识别被篡改交易: `tx-2`
- ✅ 显示: "成功检测到篡改!"

---

### TC-HASH-003: 链连续性验证

**测试目的:** 验证previousHash链接的连续性

**前置条件:** 无

**测试步骤:**
1. 创建交易链
2. 验证每笔交易的previousHash = 前一笔的hash
3. 第一笔交易的previousHash = ''

**预期结果:**
- ✅ tx-1: previousHash = ''
- ✅ tx-2: previousHash = tx-1.hash
- ✅ tx-3: previousHash = tx-2.hash

---

### TC-HASH-004: 哈希确定性

**测试目的:** 验证相同数据产生相同哈希

**前置条件:** 无

**测试步骤:**
1. 计算交易hash (id='tx-1', amount=100, timestamp=T, prevHash='')
2. 重复计算相同参数
3. 对比两个哈希值

**预期结果:**
- ✅ hash1 = hash2
- ✅ 哈希是确定性的（SHA-256特性）

---

### TC-HASH-005: 增量验证性能

**测试目的:** 验证增量验证比全量验证更快

**前置条件:** 无

**测试步骤:**
1. 创建1000笔交易链
2. 执行全量验证，记录时间T1
3. 执行增量验证（lastVerifiedIndex=900），记录时间T2
4. 对比性能

**预期结果:**
- ✅ T2 < T1
- ✅ 增量验证速度提升 > 10倍
- ✅ 两种验证结果一致

---

## 集成测试场景

### TC-INT-001: 完整安全流程

**测试目的:** 验证完整的安全工作流

**前置条件:** 全新安装

**测试步骤:**
1. 生成设备密钥对
2. 生成并保存24词助记词
3. 设置PIN码 `123456`
4. 执行生物识别认证
5. 加密敏感数据 `¥50,000`
6. 创建并验证5笔交易链

**预期结果:**
- ✅ 所有步骤成功完成
- ✅ 数据加密存储
- ✅ 交易链完整

---

### TC-INT-002: 设备丢失恢复场景

**测试目的:** 模拟设备丢失后使用助记词恢复

**前置条件:**
- 设备A已完成TC-INT-001
- 已备份24词助记词

**测试步骤:**
1. 在设备A记录设备ID和加密数据
2. 在设备B（或清除设备A数据）
3. 使用助记词恢复密钥
4. 验证设备ID一致
5. 尝试解密之前的加密数据

**预期结果:**
- ✅ 设备ID恢复一致
- ✅ 可以解密之前的数据
- ✅ 交易链验证通过

---

### TC-INT-003: 多层安全验证

**测试目的:** 验证PIN + 生物识别 + 加密 + 哈希链的多层防护

**前置条件:** 已完成基础设置

**测试步骤:**
1. 用户进入应用
2. 通过生物识别认证
3. 生物识别失败则使用PIN
4. 读取加密的财务数据
5. 验证交易链完整性

**预期结果:**
- ✅ 层层验证通过
- ✅ 未授权用户无法访问
- ✅ 篡改可被检测

---

## 性能测试

### TC-PERF-001: 字段加密性能

**测试目的:** 验证单个字段加密在10ms内完成

**前置条件:** 已生成设备密钥

**测试步骤:**
1. 准备测试数据: `Test sensitive data`
2. 执行加密100次
3. 计算平均耗时

**预期结果:**
- ✅ 单次加密 < 10ms
- ✅ 平均耗时 < 5ms
- ✅ 实际测试结果: ~5ms

---

### TC-PERF-002: 批量加密性能

**测试目的:** 验证100个字段批量加密在500ms内完成

**前置条件:** 已生成设备密钥

**测试步骤:**
1. 准备100个测试字段
2. 批量加密
3. 记录总耗时

**预期结果:**
- ✅ 批量加密(100) < 500ms
- ✅ 实际测试结果: ~21ms

---

### TC-PERF-003: 哈希链验证性能

**测试目的:** 验证1000笔交易链验证在1秒内完成

**前置条件:** 无

**测试步骤:**
1. 创建1000笔交易链
2. 执行全量验证
3. 记录耗时

**预期结果:**
- ✅ 1000笔验证 < 1000ms
- ✅ 实际测试结果: ~3ms

---

### TC-PERF-004: 加密解密往返性能

**测试目的:** 验证加密+解密往返在20ms内完成

**前置条件:** 已生成设备密钥

**测试步骤:**
1. 加密文本
2. 立即解密
3. 记录总耗时

**预期结果:**
- ✅ 往返时间 < 20ms
- ✅ 实际测试结果: ~0-2ms

---

## 安全检查清单

### 安全配置验证

- [ ] **密钥存储**: 私钥存储在FlutterSecureStorage (iOS Keychain / Android Keystore)
- [ ] **助记词存储**: 仅存储SHA-256哈希，不存储明文
- [ ] **PIN存储**: 仅存储SHA-256哈希，不存储明文
- [ ] **密钥派生**: 使用HKDF进行密钥派生
- [ ] **字段加密**: 使用ChaCha20-Poly1305 AEAD
- [ ] **数据库加密**: 使用SQLCipher AES-256-CBC
- [ ] **PBKDF2迭代**: 256,000次迭代
- [ ] **生物识别降级**: 支持降级到PIN
- [ ] **失败次数限制**: 3次失败后锁定
- [ ] **哈希链完整性**: 篡改检测正常工作

### 数据安全验证

- [ ] **无明文存储**: 敏感数据不以明文存储
- [ ] **加密传输**: （如有网络传输）使用TLS 1.3
- [ ] **密钥隔离**: 不同用户密钥完全隔离
- [ ] **数据完整性**: 哈希链保护交易完整性
- [ ] **篡改检测**: AEAD确保密文未被篡改

### 用户体验验证

- [ ] **性能达标**: 所有操作响应时间符合要求
- [ ] **错误提示**: 错误信息清晰但不泄露安全信息
- [ ] **恢复流程**: 助记词恢复流程简单可靠
- [ ] **生物识别**: 系统提示用户友好

---

## 测试报告模板

### 测试执行记录

**测试日期:** ____________
**测试人员:** ____________
**测试设备:** ____________
**系统版本:** ____________
**应用版本:** ____________

| 测试用例ID | 测试项 | 结果 | 备注 |
|-----------|--------|------|------|
| TC-KEY-001 | 生成设备密钥对 | ✅ / ❌ | |
| TC-KEY-002 | 检查密钥存在 | ✅ / ❌ | |
| TC-REC-001 | 生成助记词 | ✅ / ❌ | |
| ... | ... | ... | |

### 问题汇总

| 问题ID | 严重级别 | 问题描述 | 复现步骤 | 状态 |
|--------|---------|----------|---------|------|
| BUG-001 | 高 | ... | ... | 未修复 |

### 测试覆盖率

- [ ] 密钥管理: __/4 通过
- [ ] 恢复套件: __/5 通过
- [ ] 生物识别: __/6 通过
- [ ] PIN认证: __/8 通过
- [ ] 字段加密: __/8 通过
- [ ] 数据库加密: __/4 通过
- [ ] 哈希链: __/5 通过
- [ ] 集成测试: __/3 通过
- [ ] 性能测试: __/4 通过

**总体通过率:** _____%

---

## 附录

### A. 测试数据

```yaml
# 标准测试PIN
test_pins:
  - "123456"
  - "000000"
  - "999999"

# 标准测试文本
test_texts:
  - "Test sensitive data"
  - "敏感财务数据"
  - "こんにちは世界 🌏"
  - ""

# 标准测试金额
test_amounts:
  - 12345.67
  - -100.50
  - 0.00
  - 999999.99
```

### B. 常见问题

**Q: 生物识别在模拟器上无法测试怎么办?**
A: 生物识别必须在真机上测试。模拟器会返回 `notSupported` 状态。

**Q: 如何重置测试环境?**
A: 卸载应用重新安装，或点击 "清除所有测试数据" 按钮。

**Q: 助记词丢失怎么办?**
A: 助记词一旦丢失无法恢复，这是安全设计。测试时请妥善保存。

---

**文档结束**
**版本:** 1.0
**最后更新:** 2026-02-03
